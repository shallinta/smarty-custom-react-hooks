import{useState as t,useCallback as n,useEffect as e,useRef as r,useLayoutEffect as a}from"react";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],r=!0,a=!1,o=void 0;try{for(var i,f=t[Symbol.iterator]();!(r=(i=f.next()).done)&&(e.push(i.value),!n||e.length!==n);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==f.return||f.return()}finally{if(a)throw o}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var u=function(r){var a=i(t(!1),2),o=a[0],f=a[1],u=i(t(!1),2),c=u[0],s=u[1],l=i(t(!1),2),d=l[0],v=l[1],p=i(t(!1),2),g=p[0],y=p[1],m=n(function(t){t.target===r&&(y(!1),o||s(!1))},[o]);e(function(){return r&&r.addEventListener("transitionend",m,!1),function(){r&&r.removeEventListener("transitionend",m)}},[m]),e(function(){c&&setTimeout(function(){v(!0)},10)},[c]);var h=n(function(t){t!==o&&(g&&(s(o),v(o),y(!1)),setTimeout(function(){f(t),y(!0),t?s(!0):v(!1)},10))},[o,g]);return[c,d,h]},c={},s=null,l=null,d=!0,v=0,p=function(e,r,a,o,u){var p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=i(t(0),2),y=g[0],m=g[1],h=n(e,r),L=n(a,o),b=p.leading,T=p.trailing,w=p.maxWait,S=n(function(){if(h&&(u||!c[e])){c[e]=!0;var t=h.apply(void 0,arguments);t&&t.then?(m(function(t){return t+1}),t.then(function(t){return t},function(t){return t}).then(function(t){t&&L(t),c[e]=!1,m(function(t){return t-1})})):c[e]=!1}},[u,c,h,L]);return[y>0,n(function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];if(u){var a=(new Date).getTime();s&&clearTimeout(s),b&&d&&(d=!1,S.apply(void 0,n)),w>0&&a-v>w&&(0!==v&&S.apply(void 0,n),v=a),s=setTimeout(function(){v=0,S.apply(void 0,n),s=null,d=!0},u),T&&(l&&(clearTimeout(l),l=null),l=setTimeout(function(){S.apply(void 0,f(r)),l=null},u))}else S.apply(void 0,n)},[S,v,s,d])]},g=!1,y=function(e,r,a,o){var f=i(t(!1),2),u=f[0],c=f[1],s=n(e,r),l=n(a,o);return[u,n(function(){if(!g&&s){g=!0;var t=s.apply(void 0,arguments);t&&t.then?(c(!0),t.then(function(t){return t},function(t){return t}).then(function(t){t&&l(t),g=!1,c(!1)})):g=!1}},[g,s,c])]},m=function(){var n=i(t(0),2),r=n[0],a=n[1];return e(function(){if(0===r)return function(){};var t=setInterval(function(){a(function(t){return t>0?t-1:0})},1e3);return function(){clearInterval(t)}},[r]),[r,a]},h=function(e,r){var a=i(t(e),2),o=a[0],f=a[1],u=i(t(!1),2),c=u[0],s=u[1],l=n(function(){r instanceof RegExp?s(!r.test(o)):r instanceof Function&&s(r(o))},[r,o]);return[o,f,c,l]},L=function(r,a){var o=i(t(function(){return a&&"function"==typeof a?a:function(){}}),2),f=o[0],u=o[1],c=i(t(!1),2),s=c[0],l=c[1];return e(function(){var t=function(t){if(f&&"function"==typeof f){if(r===t.key)return void f(t.key);if(r===t.code)return void f(t.code);r===t.keyCode&&f(t.keyCode)}};return s&&window.addEventListener("keydown",t,!1),function(){s&&window.removeEventListener("keydown",t)}},[r,s,f]),[n(function(){l(!0)},[]),n(function(){l(!1)},[]),n(function(t){t&&"function"==typeof t&&u(function(){return t})},[])]},b=function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=a.namespace,u=a.dragStyle,c=a.dragData,s=a.droppingStyle,l=a.dropHandler,d=i(t(),2),v=d[0],p=d[1],g=i(t(function(){return c}),2),y=g[0],m=g[1],h=i(t(function(){return l||function(){}}),2),L=h[0],b=h[1],T=n(function(t){p(t)},[]),w=n(function(t){b(function(){return t})},[]),S=n(function(t){m(function(){return t})},[]),E=n(function(t){for(var n=t.target,e=0,r=0;n&&n!==v;)n.offsetParent?(e+=n.offsetLeft,r+=n.offsetTop,n=n.offsetParent):n=n.parentElement;var a=e+t.offsetX,o=r+t.offsetY;return[a<v.clientWidth/2,o<v.clientHeight/2]},[v]),j=n(function(t,n,e){if(v){var r=!n,a=!e,o=t.basic,i=t.left,f=t.right,u=t.top,c=t.bottom,s=t.leftTop,l=t.leftBottom,d=t.rightTop,p=t.rightBottom;o&&v.classList.add(o),i&&(n?v.classList.add(i):v.classList.remove(i)),f&&(r?v.classList.add(f):v.classList.remove(f)),u&&(e?v.classList.add(u):v.classList.remove(u)),c&&(a?v.classList.add(c):v.classList.remove(c)),s&&(n&&e?v.classList.add(s):v.classList.remove(s)),l&&(n&&a?v.classList.add(l):v.classList.remove(l)),d&&(r&&e?v.classList.add(d):v.classList.remove(d)),p&&(r&&a?v.classList.add(p):v.classList.remove(p))}},[v]);return e(function(){if(!v)return function(){};var t=function(t){return function(n){if("dragover"!==t&&"drop"!==t||n.preventDefault(),"dragstart"===t)if(n.target.dataset.dragging=!0,u&&"string"==typeof u?n.target.classList.add(u):"function"==typeof u&&u(n.target),"function"==typeof y){var e=y(n.target,n);if(e){var r=JSON.stringify({namespace:f,data:e});n.dataTransfer.setData("text/plain",r)}}else if(y){var a=JSON.stringify({namespace:f,data:y});n.dataTransfer.setData("text/plain",a)}if("dragend"===t&&(delete n.target.dataset.dragging,u&&"string"==typeof u?n.target.classList.remove(u):"function"==typeof u&&u(n.target),n.dataTransfer.setData("text/plain",null)),"dragover"===t){if(v.dataset.dragging)return;var c=i(E(n),2),l=c[0],d=c[1];s&&"string"==typeof s?v.classList.add(s):"object"===o(s)?j(s,l,d):"function"==typeof s&&s(v,"over")}if("dragleave"===t){if(v.dataset.dragging)return;s&&"string"==typeof s?v.classList.remove(s):"object"===o(s)?Object.values(s).map(function(t){return v.classList.remove(t)}):"function"==typeof s&&s(v,"leave")}if("drop"===t){if(v.dataset.dragging)return;s&&"string"==typeof s?v.classList.remove(s):"object"===o(s)?Object.values(s).map(function(t){return v.classList.remove(t)}):"function"==typeof s&&s(v,"leave");var p=n.dataTransfer.getData("text");try{p=JSON.parse(p)}catch(t){return}if(!p||p.namespace!==f)return;var g=i(E(n),2),m=g[0],h=g[1],b=p.data;L&&"function"==typeof L&&L(b,{isLeft:m,isTop:h},v)}}},n=["dragstart","dragend"],e=["dragleave","dragover","drop"],a=[];switch(r){case"drag":a.push.apply(a,n),v.draggable=!0;break;case"drop":a.push.apply(a,e);break;case"drag-n-drop":a.push.apply(a,n.concat(e)),v.draggable=!0}var c=a.map(function(n){return{eventName:n,handler:t(n)}});return c.forEach(function(t){var n=t.eventName,e=t.handler;v.addEventListener(n,e,!1)}),function(){c.forEach(function(t){var n=t.eventName,e=t.handler;v.removeEventListener(n,e)})}},[v,y,L]),[T,w,S]};function T(){var t=r(!0);return t.current?(t.current=!1,!0):t.current}var w=function(t,n){var r=T();e(function(){if(!r)return t()},n)},S=function(t,n){var e=T();a(function(){if(!e)return t()},n)};export{u as useAnimation,p as useAsyncDebounce,y as useAsync,m as useCountdown,h as useInput,L as useKeyDown,b as useDragNDrop,w as useUpdateEffect,S as useUpdateLayoutEffect,T as useFirstMountState};
